(()=>{"use strict";var t={104:(t,e,n)=>{t.exports=n.p+"e8c99a8916b6ebd66093.wasm"}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}let i;n.m=t,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=i[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href;const r=new Array(128).fill(void 0);function o(t){return r[t]}r.push(void 0,null,!0,!1);let s=r.length;function a(t){s===r.length&&r.push(r.length+1);const e=s;return s=r[e],r[e]=t,e}function l(t,e){try{return t.apply(this,e)}catch(t){i.__wbindgen_exn_store(a(t))}}function u(t){const e=o(t);return function(t){t<132||(r[t]=s,s=t)}(t),e}function c(t){return null==t}let d=null;function f(){return(null===d||!0===d.buffer.detached||void 0===d.buffer.detached&&d.buffer!==i.memory.buffer)&&(d=new DataView(i.memory.buffer)),d}function _(t){const e=typeof t;if("number"==e||"boolean"==e||null==t)return`${t}`;if("string"==e)return`"${t}"`;if("symbol"==e){const e=t.description;return null==e?"Symbol":`Symbol(${e})`}if("function"==e){const e=t.name;return"string"==typeof e&&e.length>0?`Function(${e})`:"Function"}if(Array.isArray(t)){const e=t.length;let n="[";e>0&&(n+=_(t[0]));for(let i=1;i<e;i++)n+=", "+_(t[i]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let i;if(!(n&&n.length>1))return toString.call(t);if(i=n[1],"Object"==i)try{return"Object("+JSON.stringify(t)+")"}catch(t){return"Object"}return t instanceof Error?`${t.name}: ${t.message}\n${t.stack}`:i}let b=0,g=null;function h(){return null!==g&&0!==g.byteLength||(g=new Uint8Array(i.memory.buffer)),g}const p="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},w="function"==typeof p.encodeInto?function(t,e){return p.encodeInto(t,e)}:function(t,e){const n=p.encode(t);return e.set(n),{read:t.length,written:n.length}};function v(t,e,n){if(void 0===n){const n=p.encode(t),i=e(n.length,1)>>>0;return h().subarray(i,i+n.length).set(n),b=n.length,i}let i=t.length,r=e(i,1)>>>0;const o=h();let s=0;for(;s<i;s++){const e=t.charCodeAt(s);if(e>127)break;o[r+s]=e}if(s!==i){0!==s&&(t=t.slice(s)),r=n(r,i,i=s+3*t.length,1)>>>0;const e=h().subarray(r+s,r+i);s+=w(t,e).written,r=n(r,i,s,1)>>>0}return b=s,r}const m="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function y(t,e){return t>>>=0,m.decode(h().subarray(t,t+e))}"undefined"!=typeof TextDecoder&&m.decode();const $="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_game_free(t>>>0,1)));class E{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,$.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_game_free(t,0)}constructor(){const t=i.game_new();return this.__wbg_ptr=t>>>0,$.register(this,this.__wbg_ptr,this),this}get data(){return u(i.game_data(this.__wbg_ptr))}get guess_data(){return u(i.game_guess_data(this.__wbg_ptr))}generate(t,e){i.game_generate(this.__wbg_ptr,t,e)}is_filled(){return 0!==i.game_is_filled(this.__wbg_ptr)}update_cell(t,e){return 0!==i.game_update_cell(this.__wbg_ptr,a(t),e)}auto_fill(){return u(i.game_auto_fill(this.__wbg_ptr))}restart(){i.game_restart(this.__wbg_ptr)}erase(t){return 0!==i.game_erase(this.__wbg_ptr,a(t))}undo(){return 0!==i.game_undo(this.__wbg_ptr)}}function x(){const t={wbg:{}};return t.wbg.__wbg_buffer_609cc3eee51ed158=function(t){return a(o(t).buffer)},t.wbg.__wbg_call_672a4d21634d4a24=function(){return l((function(t,e){return a(o(t).call(o(e)))}),arguments)},t.wbg.__wbg_done_769e5ede4b31c67b=function(t){return o(t).done},t.wbg.__wbg_floor_3206eb41fe582a22=function(t){return Math.floor(t)},t.wbg.__wbg_get_67b2ba62fc30de12=function(){return l((function(t,e){return a(Reflect.get(o(t),o(e)))}),arguments)},t.wbg.__wbg_get_b9b93047fe3cf45b=function(t,e){return a(o(t)[e>>>0])},t.wbg.__wbg_instanceof_ArrayBuffer_e14585432e3737fc=function(t){let e;try{e=o(t)instanceof ArrayBuffer}catch(t){e=!1}return e},t.wbg.__wbg_instanceof_Uint8Array_17156bcf118086a9=function(t){let e;try{e=o(t)instanceof Uint8Array}catch(t){e=!1}return e},t.wbg.__wbg_isArray_a1eab7e0d067391b=function(t){return Array.isArray(o(t))},t.wbg.__wbg_isSafeInteger_343e2beeeece1bb0=function(t){return Number.isSafeInteger(o(t))},t.wbg.__wbg_iterator_9a24c88df860dc65=function(){return a(Symbol.iterator)},t.wbg.__wbg_length_a446193dc22c12f8=function(t){return o(t).length},t.wbg.__wbg_length_e2d2a49132c1b256=function(t){return o(t).length},t.wbg.__wbg_new_78feb108b6472713=function(){return a(new Array)},t.wbg.__wbg_new_a12002a7f91c75be=function(t){return a(new Uint8Array(o(t)))},t.wbg.__wbg_next_25feadfc0913fea9=function(t){return a(o(t).next)},t.wbg.__wbg_next_6574e1a8a62d1055=function(){return l((function(t){return a(o(t).next())}),arguments)},t.wbg.__wbg_random_3ad904d98382defe=function(){return Math.random()},t.wbg.__wbg_set_37837023f3d740e8=function(t,e,n){o(t)[e>>>0]=u(n)},t.wbg.__wbg_set_65595bdd868b3009=function(t,e,n){o(t).set(o(e),n>>>0)},t.wbg.__wbg_value_cd1ffa7b1ab794f1=function(t){return a(o(t).value)},t.wbg.__wbindgen_bigint_from_u64=function(t){return a(BigInt.asUintN(64,t))},t.wbg.__wbindgen_bigint_get_as_i64=function(t,e){const n=o(e),i="bigint"==typeof n?n:void 0;f().setBigInt64(t+8,c(i)?BigInt(0):i,!0),f().setInt32(t+0,!c(i),!0)},t.wbg.__wbindgen_boolean_get=function(t){const e=o(t);return"boolean"==typeof e?e?1:0:2},t.wbg.__wbindgen_debug_string=function(t,e){const n=v(_(o(e)),i.__wbindgen_malloc,i.__wbindgen_realloc),r=b;f().setInt32(t+4,r,!0),f().setInt32(t+0,n,!0)},t.wbg.__wbindgen_error_new=function(t,e){return a(new Error(y(t,e)))},t.wbg.__wbindgen_is_bigint=function(t){return"bigint"==typeof o(t)},t.wbg.__wbindgen_is_function=function(t){return"function"==typeof o(t)},t.wbg.__wbindgen_is_object=function(t){const e=o(t);return"object"==typeof e&&null!==e},t.wbg.__wbindgen_jsval_eq=function(t,e){return o(t)===o(e)},t.wbg.__wbindgen_jsval_loose_eq=function(t,e){return o(t)==o(e)},t.wbg.__wbindgen_memory=function(){return a(i.memory)},t.wbg.__wbindgen_number_get=function(t,e){const n=o(e),i="number"==typeof n?n:void 0;f().setFloat64(t+8,c(i)?0:i,!0),f().setInt32(t+0,!c(i),!0)},t.wbg.__wbindgen_number_new=function(t){return a(t)},t.wbg.__wbindgen_object_drop_ref=function(t){u(t)},t.wbg.__wbindgen_string_get=function(t,e){const n=o(e),r="string"==typeof n?n:void 0;var s=c(r)?0:v(r,i.__wbindgen_malloc,i.__wbindgen_realloc),a=b;f().setInt32(t+4,a,!0),f().setInt32(t+0,s,!0)},t.wbg.__wbindgen_throw=function(t,e){throw new Error(y(t,e))},t}async function C(t){if(void 0!==i)return i;void 0!==t&&(Object.getPrototypeOf(t)===Object.prototype?({module_or_path:t}=t):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===t&&(t=new URL(n(104),n.b));const e=x();("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:r,module:o}=await async function(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"==t.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}(await t,e);return function(t,e){return i=t.exports,C.__wbindgen_wasm_module=e,d=null,g=null,i}(r,o)}const S=C;class L{constructor(t,e){this.$container=document.querySelector(`#${t}`),this.title=e}render(){this.$container.innerHTML=`\n  <h1>${this.title}</h1>\n\n  <canvas id="scene"></canvas>\n\n  <p>\n    <pre id="debug"></pre>\n  </p>\n\n  <div class="controls">\n    <div>\n      <button id="generate">Generate</button>\n      <button id="restart">Restart</button>\n    </div>\n    <div>\n      <button id="erase">Erase</button>\n      <button id="undo">Undo</button>\n    </div>\n    <div>\n      <label>Auto-fill</label>\n      <input type="checkbox" id="auto-fill"></input>\n    </div>\n    <div>\n      <label>Shuffle count: <span id="shuffle-count-value">1</span></label>\n      <input type="range" id="shuffle-count" value="1"></input>\n    </div>\n    <div>\n      <label>Difficulty: <span id="difficulty-value" max="100">1</span></label>\n      <input type="range" id="difficulty" value="1" max="80"></input>\n    </div>\n\n    <div class="inputs">\n      ${[...Array(9).keys()].reduce(((t,e)=>t+`<div class="inputs__button" data-value="${e+1}">${e+1}</div>`),"")}\n    </div>\n  </div>\n\n  <style>\n    #scene {\n      cursor: pointer;\n    }\n    .controls {\n      display: flex;\n      flex-flow: column wrap;\n      align-items: center;\n      justify-content: center;\n    }\n    .controls > * {\n      margin-bottom: 1rem\n    }\n\n    #auto-fill {\n      position: relative;\n      top: 0.15rem;\n    }\n    #difficulty {\n      position: relative;\n      top: 0.25rem;\n    }\n\n    .inputs {\n      display: flex;\n      flex-flow: row wrap;\n      max-width: 300px;\n      margin-left: auto;\n      margin-right: auto;\n      align-items: center;\n      justify-content: center;\n    }\n    .inputs__button {\n      display: inline;\n      width: calc((100% - 3rem) / 3);\n      box-sizing: border-box;\n      border: 1px solid black;\n      margin: 0.5rem;\n      padding: 0.5rem;\n      cursor: pointer;\n    }\n    .inputs__button--selected {\n      border: 1px solid green;\n      color: green;\n    }\n  </style>\n    `}}const I=[...Array(3).keys()],A=170,k=A/3,B={PRIMARY:[240,240,240,1],SECONDARY:[170,170,170,1],LINES:[0,0,0,1],TEXT:[0,0,0,1],BACKGROUND:[0,0,0,1],HIGHLIGHT:[255,0,0,1],VALID:[0,255,0,1]},T=class{constructor(t){this.selectedPosition=null,this.filledPositions=[],this.$canvas=t,this.context=this.$canvas.getContext("2d"),this.$canvas.width=510,this.$canvas.height=510,this.$canvas.style.backgroundColor=this.rgba(B.BACKGROUND)}render(t,e){this.context.clearRect(0,0,this.$canvas.width,this.$canvas.height),[...Array(9).keys()].map((n=>{const i=Math.floor(n/3),r=n%3,o=!(i%2)&&r%2||i%2&&!(r%2)?B.SECONDARY:B.PRIMARY,s=[r*A,i*A],a=[3*i,3*r];this.drawZoneBackground(s,o),this.drawZoneCells(I.map((e=>t[a[0]+e].slice(a[1],a[1]+3))),I.map((t=>e[a[0]+t].slice(a[1],a[1]+3))),s,k,B.LINES,B.TEXT)})),this.selectedPosition&&this.drawSquareLines([this.selectedPosition[0]*k,this.selectedPosition[1]*k],k,B.HIGHLIGHT),this.filledPositions.map((t=>{this.drawSquareLines([t[0]*k,t[1]*k],k,B.VALID)}))}drawSquareLines(t,e,n){this.context.strokeStyle=this.rgba(n),this.context.beginPath(),this.context.moveTo(t[0],t[1]),this.context.lineTo(t[0]+e,t[1]),this.context.lineTo(t[0]+e,t[1]+e),this.context.lineTo(t[0],t[1]+e),this.context.lineTo(t[0],t[1]),this.context.stroke()}drawZoneCells(t,e,n,i,r,o){[...Array(9).keys()].map((s=>{const a=Math.floor(s/3),l=s%3,u=[n[0]+l*i,n[1]+a*i],c=t[a][l]||e[a][l];this.drawSquareLines(u,i,r),this.context.fillStyle=this.rgba(o),isNaN(Number(c))?(this.context.font="10px Arial",c.map(((t,e)=>{const n=Math.floor(e/3),r=e%3;t&&this.context.fillText(`${t}`,u[0]+i/3*r+i/3/2.6,u[1]+i/3*n+i/3/1.5)}))):(this.context.font="24px Arial",this.context.fillText(`${c}`,u[0]+i/2.5,u[1]+i/1.6))}))}drawZoneBackground(t,e){this.context.fillStyle=this.rgba(e),this.context.fillRect(t[0],t[1],A,A)}rgba(t){return`rgba(${t.join(", ")})`}};var P;!function(t){t.PositionSelected="position-selected",t.InputSelected="input-selected",t.Generate="generate",t.AutoFill="auto-fill",t.DifficultyUpdated="difficulty-updated",t.ShuffleCountUpdated="shuffle-count-updated",t.Restart="restart",t.Erase="erase",t.Undo="undo"}(P||(P={}));const R=class{constructor(t){this.$eventListener=document.createElement("div"),this.elements=t,this.setEventListeners()}addEventListener(t,e){this.$eventListener.addEventListener(t,(t=>e(t)))}setEventListeners(){this.elements.$canvas.addEventListener("click",(t=>this.onCanvasClickCallback(t))),this.elements.$inputButtons.map((t=>{t.addEventListener("click",(t=>{this.onInputButtonCallback(t)}))})),this.elements.$generateButton.addEventListener("click",(()=>{this.onGenerateButtonEventCallback()})),this.elements.$autoFillInput.addEventListener("change",(()=>this.onAutoFillInputEventCallback())),this.elements.$shuffleCountInput.addEventListener("change",(()=>this.onShuffleCountInputEventCallback())),this.elements.$difficultyInput.addEventListener("change",(()=>this.onDifficultyInputEventCallback())),this.elements.$restartButton.addEventListener("click",(()=>{this.onRestartButtonkEventCallback()})),this.elements.$eraseButton.addEventListener("click",(()=>{this.onEraseButtonEventCallback()})),this.elements.$undoButton.addEventListener("click",(()=>{this.onUndoButtonEventCallback()}))}onCanvasClickCallback(t){const e=this.elements.$canvas.getBoundingClientRect(),n=t.clientX-e.left,i=t.clientY-e.top;this.$eventListener.dispatchEvent(new CustomEvent(P.PositionSelected,{detail:{position:[Math.floor(n/k),Math.floor(i/k)]}})),this.elements.$inputButtons.map((t=>{t.classList.remove("inputs__button--selected")}))}onInputButtonCallback(t){const e=t.target,n=e.getAttribute("data-value");this.$eventListener.dispatchEvent(new CustomEvent(P.InputSelected,{detail:{value:""!==n?Number(n):null}})),this.elements.$inputButtons.map((t=>{t.classList.remove("inputs__button--selected")})),e.classList.add("inputs__button--selected")}onGenerateButtonEventCallback(){this.$eventListener.dispatchEvent(new CustomEvent(P.Generate))}onAutoFillInputEventCallback(){this.$eventListener.dispatchEvent(new CustomEvent(P.AutoFill,{detail:{autoFill:this.elements.$autoFillInput.checked}}))}onDifficultyInputEventCallback(){const t=Number(this.elements.$difficultyInput.value)||1;this.$eventListener.dispatchEvent(new CustomEvent(P.DifficultyUpdated,{detail:{difficulty:t}})),this.elements.$difficultyText.innerText=String(t||"0")}onShuffleCountInputEventCallback(){const t=Number(this.elements.$shuffleCountInput.value)||1;this.$eventListener.dispatchEvent(new CustomEvent(P.ShuffleCountUpdated,{detail:{shufflCount:t}})),this.elements.$shuffleCountText.innerText=String(t||"0")}onRestartButtonkEventCallback(){this.$eventListener.dispatchEvent(new CustomEvent(P.Restart))}onEraseButtonEventCallback(){this.$eventListener.dispatchEvent(new CustomEvent(P.Erase))}onUndoButtonEventCallback(){this.$eventListener.dispatchEvent(new CustomEvent(P.Undo))}};function q(t){setTimeout((()=>{t.filledPositions=[]}),500)}window.addEventListener("load",(()=>{S().then((()=>{const t=new L("app","Sudoku");t.render();const e=t.$container.querySelector("#debug"),n=new T(t.$container.querySelector("#scene")),i=new R({$canvas:t.$container.querySelector("#scene"),$inputButtons:[...t.$container.querySelectorAll(".inputs__button").values()],$generateButton:t.$container.querySelector("#generate"),$autoFillInput:t.$container.querySelector("#auto-fill"),$shuffleCountInput:t.$container.querySelector("#shuffle-count"),$shuffleCountText:t.$container.querySelector("#shuffle-count-value"),$difficultyInput:t.$container.querySelector("#difficulty"),$difficultyText:t.$container.querySelector("#difficulty-value"),$restartButton:t.$container.querySelector("#restart"),$eraseButton:t.$container.querySelector("#erase"),$undoButton:t.$container.querySelector("#undo")}),r=new E,o={selectedPosition:null,autoFill:!1,shuffleCount:10,difficulty:1,finished:!1};i.addEventListener(P.InputSelected,(t=>{const{value:e}=t.detail;!e||0>e||!o.selectedPosition?console.error("missing value or position"):r.update_cell(o.selectedPosition,e)?r.is_filled()?(o.finished=!0,setTimeout((()=>{alert("Finished!")}),500)):(n.filledPositions=[o.selectedPosition],q(n)):console.error(`not allowed to update [${o.selectedPosition}] with value ${e} or stack not updated`)})),i.addEventListener(P.Restart,(()=>r.restart())),i.addEventListener(P.Erase,(()=>{o.selectedPosition&&!r.erase(o.selectedPosition)&&console.error(`not allowed to erase [${o.selectedPosition}]`)})),i.addEventListener(P.Generate,(()=>{r.generate(100*o.shuffleCount,o.difficulty),o.finished=!1})),i.addEventListener(P.Undo,(()=>r.undo())),i.addEventListener(P.PositionSelected,(t=>{o.selectedPosition=t.detail.position,n.selectedPosition=t.detail.position})),i.addEventListener(P.AutoFill,(t=>{o.autoFill=Boolean(t.detail.autoFill)})),i.addEventListener(P.DifficultyUpdated,(t=>{o.difficulty=Number(t.detail.difficulty)})),i.addEventListener(P.ShuffleCountUpdated,(t=>{o.shuffleCount=Number(t.detail.shufflCount)})),setInterval((()=>{!o.finished&&o.autoFill&&(n.filledPositions=r.auto_fill(),q(n))}),1e3);let s=0;const a=()=>{s>0&&(e.innerText=r.is_filled()?"filled and valid":"not filled or not valid",n.render(r.data,r.guess_data)),s=requestAnimationFrame(a)};requestAnimationFrame(a)}))}))})();