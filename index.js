(()=>{"use strict";var t={104:(t,e,n)=>{t.exports=n.p+"c48b2730cb53f969a5fc.wasm"}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}let r;n.m=t,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=r[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href;const i=new Array(128).fill(void 0);function o(t){return i[t]}i.push(void 0,null,!0,!1);let s=i.length;function a(t){s===i.length&&i.push(i.length+1);const e=s;return s=i[e],i[e]=t,e}function c(t,e){try{return t.apply(this,e)}catch(t){r.__wbindgen_exn_store(a(t))}}const l="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&l.decode();let u=null;function _(){return null!==u&&0!==u.byteLength||(u=new Uint8Array(r.memory.buffer)),u}function d(t,e){return t>>>=0,l.decode(_().subarray(t,t+e))}function b(t){const e=o(t);return function(t){t<132||(i[t]=s,s=t)}(t),e}function f(t){return null==t}let g=null;function w(){return(null===g||!0===g.buffer.detached||void 0===g.buffer.detached&&g.buffer!==r.memory.buffer)&&(g=new DataView(r.memory.buffer)),g}function h(t){const e=typeof t;if("number"==e||"boolean"==e||null==t)return`${t}`;if("string"==e)return`"${t}"`;if("symbol"==e){const e=t.description;return null==e?"Symbol":`Symbol(${e})`}if("function"==e){const e=t.name;return"string"==typeof e&&e.length>0?`Function(${e})`:"Function"}if(Array.isArray(t)){const e=t.length;let n="[";e>0&&(n+=h(t[0]));for(let r=1;r<e;r++)n+=", "+h(t[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(!(n&&n.length>1))return toString.call(t);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(t)+")"}catch(t){return"Object"}return t instanceof Error?`${t.name}: ${t.message}\n${t.stack}`:r}let p=0;const y="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},m="function"==typeof y.encodeInto?function(t,e){return y.encodeInto(t,e)}:function(t,e){const n=y.encode(t);return e.set(n),{read:t.length,written:n.length}};function v(t,e,n){if(void 0===n){const n=y.encode(t),r=e(n.length,1)>>>0;return _().subarray(r,r+n.length).set(n),p=n.length,r}let r=t.length,i=e(r,1)>>>0;const o=_();let s=0;for(;s<r;s++){const e=t.charCodeAt(s);if(e>127)break;o[i+s]=e}if(s!==r){0!==s&&(t=t.slice(s)),i=n(i,r,r=s+3*t.length,1)>>>0;const e=_().subarray(i+s,i+r);s+=m(t,e).written,i=n(i,r,s,1)>>>0}return p=s,i}const x="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>r.__wbg_sudoku_free(t>>>0,1)));class ${__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,x.unregister(this),t}free(){const t=this.__destroy_into_raw();r.__wbg_sudoku_free(t,0)}constructor(){const t=r.sudoku_new();return this.__wbg_ptr=t>>>0,x.register(this,this.__wbg_ptr,this),this}get data(){return b(r.sudoku_data(this.__wbg_ptr))}get guess_data(){return b(r.sudoku_guess_data(this.__wbg_ptr))}generate(){r.sudoku_generate(this.__wbg_ptr)}update_cell(t,e){return 0!==r.sudoku_update_cell(this.__wbg_ptr,a(t),e)}get_related_cells_positions(t){return b(r.sudoku_get_related_cells_positions(this.__wbg_ptr,a(t)))}auto_fill(){return b(r.sudoku_auto_fill(this.__wbg_ptr))}is_filled(){return 0!==r.sudoku_is_filled(this.__wbg_ptr)}}function A(){const t={wbg:{}};return t.wbg.__wbg_buffer_609cc3eee51ed158=function(t){return a(o(t).buffer)},t.wbg.__wbg_call_672a4d21634d4a24=function(){return c((function(t,e){return a(o(t).call(o(e)))}),arguments)},t.wbg.__wbg_done_769e5ede4b31c67b=function(t){return o(t).done},t.wbg.__wbg_floor_3206eb41fe582a22=function(t){return Math.floor(t)},t.wbg.__wbg_get_67b2ba62fc30de12=function(){return c((function(t,e){return a(Reflect.get(o(t),o(e)))}),arguments)},t.wbg.__wbg_get_b9b93047fe3cf45b=function(t,e){return a(o(t)[e>>>0])},t.wbg.__wbg_instanceof_ArrayBuffer_e14585432e3737fc=function(t){let e;try{e=o(t)instanceof ArrayBuffer}catch(t){e=!1}return e},t.wbg.__wbg_instanceof_Uint8Array_17156bcf118086a9=function(t){let e;try{e=o(t)instanceof Uint8Array}catch(t){e=!1}return e},t.wbg.__wbg_isArray_a1eab7e0d067391b=function(t){return Array.isArray(o(t))},t.wbg.__wbg_isSafeInteger_343e2beeeece1bb0=function(t){return Number.isSafeInteger(o(t))},t.wbg.__wbg_iterator_9a24c88df860dc65=function(){return a(Symbol.iterator)},t.wbg.__wbg_length_a446193dc22c12f8=function(t){return o(t).length},t.wbg.__wbg_length_e2d2a49132c1b256=function(t){return o(t).length},t.wbg.__wbg_log_aee815fd2bed7c4f=function(t,e){console.log(d(t,e))},t.wbg.__wbg_new_78feb108b6472713=function(){return a(new Array)},t.wbg.__wbg_new_a12002a7f91c75be=function(t){return a(new Uint8Array(o(t)))},t.wbg.__wbg_next_25feadfc0913fea9=function(t){return a(o(t).next)},t.wbg.__wbg_next_6574e1a8a62d1055=function(){return c((function(t){return a(o(t).next())}),arguments)},t.wbg.__wbg_set_37837023f3d740e8=function(t,e,n){o(t)[e>>>0]=b(n)},t.wbg.__wbg_set_65595bdd868b3009=function(t,e,n){o(t).set(o(e),n>>>0)},t.wbg.__wbg_value_cd1ffa7b1ab794f1=function(t){return a(o(t).value)},t.wbg.__wbindgen_bigint_from_u64=function(t){return a(BigInt.asUintN(64,t))},t.wbg.__wbindgen_bigint_get_as_i64=function(t,e){const n=o(e),r="bigint"==typeof n?n:void 0;w().setBigInt64(t+8,f(r)?BigInt(0):r,!0),w().setInt32(t+0,!f(r),!0)},t.wbg.__wbindgen_boolean_get=function(t){const e=o(t);return"boolean"==typeof e?e?1:0:2},t.wbg.__wbindgen_debug_string=function(t,e){const n=v(h(o(e)),r.__wbindgen_malloc,r.__wbindgen_realloc),i=p;w().setInt32(t+4,i,!0),w().setInt32(t+0,n,!0)},t.wbg.__wbindgen_error_new=function(t,e){return a(new Error(d(t,e)))},t.wbg.__wbindgen_is_bigint=function(t){return"bigint"==typeof o(t)},t.wbg.__wbindgen_is_function=function(t){return"function"==typeof o(t)},t.wbg.__wbindgen_is_object=function(t){const e=o(t);return"object"==typeof e&&null!==e},t.wbg.__wbindgen_jsval_eq=function(t,e){return o(t)===o(e)},t.wbg.__wbindgen_jsval_loose_eq=function(t,e){return o(t)==o(e)},t.wbg.__wbindgen_memory=function(){return a(r.memory)},t.wbg.__wbindgen_number_get=function(t,e){const n=o(e),r="number"==typeof n?n:void 0;w().setFloat64(t+8,f(r)?0:r,!0),w().setInt32(t+0,!f(r),!0)},t.wbg.__wbindgen_number_new=function(t){return a(t)},t.wbg.__wbindgen_object_drop_ref=function(t){b(t)},t.wbg.__wbindgen_string_get=function(t,e){const n=o(e),i="string"==typeof n?n:void 0;var s=f(i)?0:v(i,r.__wbindgen_malloc,r.__wbindgen_realloc),a=p;w().setInt32(t+4,a,!0),w().setInt32(t+0,s,!0)},t.wbg.__wbindgen_throw=function(t,e){throw new Error(d(t,e))},t}async function k(t){if(void 0!==r)return r;void 0!==t&&(Object.getPrototypeOf(t)===Object.prototype?({module_or_path:t}=t):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===t&&(t=new URL(n(104),n.b));const e=A();("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:i,module:o}=await async function(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"==t.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}(await t,e);return function(t,e){return r=t.exports,k.__wbindgen_wasm_module=e,g=null,u=null,r}(i,o)}const E=k;class S{constructor(t,e){this.$container=document.querySelector(`#${t}`),this.title=e}render(){this.$container.innerHTML=`\n  <h1>${this.title}</h1>\n\n  <canvas id="scene"></canvas>\n\n  <p>\n    <pre id="map"></pre>\n  </p>\n\n  <button id="generate">Generate</button>\n\n  <div class="controls">\n    ${[...Array(9).keys()].reduce(((t,e)=>t+`<div class="controls__button" data-value="${e+1}">${e+1}</div>`),"")}\n  </div>\n  <style>\n    #scene {\n      cursor: pointer;\n    }\n    .controls {\n      display: flex;\n      flex-flow: row wrap;\n      max-width: 300px;\n      margin-left: auto;\n      margin-right: auto;\n      margin-top: 1rem;\n    }\n    .controls__button {\n      display: inline;\n      width: calc((100% - 3rem) / 3);\n      box-sizing: border-box;\n      border: 1px solid black;\n      margin: 0.5rem;\n      padding: 0.5rem;\n      cursor: pointer;\n    }\n    .controls__button--selected {\n      border: 1px solid green;\n      color: green;\n    }\n  </style>\n    `}}const L=[...Array(3).keys()],I=200,C=I/3,T={PRIMARY:[240,240,240,1],SECONDARY:[170,170,170,1],LINES:[0,0,0,1],TEXT:[0,0,0,1],BACKGROUND:[0,0,0,1],HIGHLIGHT:[255,0,0,1],VALID:[0,255,0,1]},B=class{constructor(t,e,n){this.selectedPosition=null,this.filledPositions=[],this.$eventListener=document.createElement("div"),this.$canvas=t,this.$inputButtons=e,this.$generateButton=n,this.context=this.$canvas.getContext("2d"),this.$canvas.width=600,this.$canvas.height=600,this.$canvas.style.backgroundColor=this.rgba(T.BACKGROUND),this.$canvas.addEventListener("click",(t=>this.onMouseClickCallback(t))),this.$inputButtons.map((t=>{t.addEventListener("click",(t=>{this.onInputButtonClickCallback(t)}))})),this.$generateButton.addEventListener("click",(t=>{this.onGenerateButtonClickEventCallback(t)}))}onMouseClickCallback(t){const e=this.$canvas.getBoundingClientRect(),n=t.clientX-e.left,r=t.clientY-e.top;this.selectedPosition=[Math.floor(n/C),Math.floor(r/C)],this.$eventListener.dispatchEvent(new CustomEvent("position-selected",{detail:{position:this.selectedPosition}})),this.$inputButtons.map((t=>{t.classList.remove("controls__button--selected")}))}onInputButtonClickCallback(t){const e=t.target,n=e.getAttribute("data-value");this.$eventListener.dispatchEvent(new CustomEvent("input-selected",{detail:{value:""!==n?Number(n):null}})),this.$inputButtons.map((t=>{t.classList.remove("controls__button--selected")})),e.classList.add("controls__button--selected")}onGenerateButtonClickEventCallback(t){this.$eventListener.dispatchEvent(new CustomEvent("generate-new"))}render(t,e){this.context.clearRect(0,0,this.$canvas.width,this.$canvas.height),[...Array(9).keys()].map((n=>{const r=Math.floor(n/3),i=n%3,o=!(r%2)&&i%2||r%2&&!(i%2)?T.SECONDARY:T.PRIMARY,s=[i*I,r*I],a=[3*r,3*i];this.drawZoneBackground(s,o),this.drawZoneCells(L.map((e=>t[a[0]+e].slice(a[1],a[1]+3))),L.map((t=>e[a[0]+t].slice(a[1],a[1]+3))),s,C,T.LINES,T.TEXT)})),this.selectedPosition&&this.drawSquareLines([this.selectedPosition[0]*C,this.selectedPosition[1]*C],C,T.HIGHLIGHT),this.filledPositions.map((t=>{this.drawSquareLines([t[0]*C,t[1]*C],C,T.VALID)}))}drawSquareLines(t,e,n){this.context.strokeStyle=this.rgba(n),this.context.beginPath(),this.context.moveTo(t[0],t[1]),this.context.lineTo(t[0]+e,t[1]),this.context.lineTo(t[0]+e,t[1]+e),this.context.lineTo(t[0],t[1]+e),this.context.lineTo(t[0],t[1]),this.context.stroke()}drawZoneCells(t,e,n,r,i,o){[...Array(9).keys()].map((s=>{const a=Math.floor(s/3),c=s%3,l=[n[0]+c*r,n[1]+a*r],u=t[a][c]||e[a][c];this.drawSquareLines(l,r,i),this.context.fillStyle=this.rgba(o),isNaN(Number(u))?(this.context.font="10px Arial",u.map(((t,e)=>{const n=Math.floor(e/3),i=e%3;t&&this.context.fillText(`${t}`,l[0]+r/3*i+r/3/2.6,l[1]+r/3*n+r/3/1.5)}))):(this.context.font="24px Arial",this.context.fillText(`${u}`,l[0]+r/2.5,l[1]+r/1.6))}))}drawZoneBackground(t,e){this.context.fillStyle=this.rgba(e),this.context.fillRect(t[0],t[1],I,I)}rgba(t){return`rgba(${t.join(", ")})`}};window.addEventListener("load",(()=>{E().then((()=>{const t=new S("app","Sudoku");t.render();const e=t.$container.querySelector("#map"),n=new B(t.$container.querySelector("#scene"),[...t.$container.querySelectorAll(".controls__button").values()],t.$container.querySelector("#generate")),r=new $;let i=null;const o=t=>{t.position&&(i=t.position,console.log(i)),(t.value||0===t.value)&&i&&(console.log(`updating [${i.join(", ")}] with ${t.value}...`),r.update_cell(i,t.value)?r.is_filled()&&setTimeout((()=>{alert("finished!")}),1e3):alert(`unable to update [${i.join(", ")}] with ${t.value}`))};n.$eventListener.addEventListener("position-selected",(t=>{o(t.detail)})),n.$eventListener.addEventListener("input-selected",(t=>{o(t.detail)})),n.$eventListener.addEventListener("generate-new",(t=>{console.log("generating new data requested..."),r.generate()}));let s=0;const a=()=>{s>0&&(e.innerText=r.is_filled()?"filled and valid":"not filled",n.render(r.data,r.guess_data)),s=requestAnimationFrame(a)};requestAnimationFrame(a)}))}))})();